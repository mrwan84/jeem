// =============================================
// Test: Statements and Control Flow
// =============================================

print("=== Statement Tests ===\n")

// Test 1: Variable assignment
print("Test 1: Variable Assignment")
x = 10
y = 20
z = x + y
print("  x = 10, y = 20, z = x + y =", z)
assert(z == 30, "assignment failed")
print("  [OK] Assignment works")

// Test 2: Const
print("\nTest 2: Constants")
const MY_PI = 3.14159
const NAME = "Jeem"
print("  const MY_PI =", MY_PI)
print("  const NAME =", NAME)
print("  [OK] Constants work")

// Test 3: If/Else
print("\nTest 3: If/Else")
value = 15
result = ""
if (value > 10) {
    result = "greater"
} else {
    result = "less or equal"
}
print("  if (15 > 10) result:", result)
assert(result == "greater", "if failed")

result = ""
if (value < 10) {
    result = "less"
} else if (value == 15) {
    result = "equal to 15"
} else {
    result = "other"
}
print("  else if result:", result)
assert(result == "equal to 15", "else if failed")
print("  [OK] If/Else works")

// Test 4: Ternary operator
print("\nTest 4: Ternary Operator")
a = 5
b = a > 3 ? "yes" : "no"
print("  5 > 3 ? 'yes' : 'no' =", b)
assert(b == "yes", "ternary failed")
print("  [OK] Ternary works")

// Test 5: While loop
print("\nTest 5: While Loop")
counter = 0
while (counter < 5) {
    counter = counter + 1
}
print("  while (counter < 5) counter =", counter)
assert(counter == 5, "while failed")
print("  [OK] While loop works")

// Test 6: For-in loop (array)
print("\nTest 6: For-in Loop (Array)")
arr = [10, 20, 30]
sum = 0
for item in arr {
    sum = sum + item
}
print("  for item in [10,20,30] sum =", sum)
assert(sum == 60, "for-in array failed")
print("  [OK] For-in (array) works")

// Test 7: For-in loop with index
print("\nTest 7: For-in Loop with Index")
items = ["a", "b", "c"]
result = ""
for item, idx in items {
    result = result + str(idx) + ":" + item + " "
}
print("  for item, idx in items:", result)
assert(result == "0:a 1:b 2:c ", "for-in index failed")
print("  [OK] For-in with index works")

// Test 8: For-in loop (object)
print("\nTest 8: For-in Loop (Object)")
obj = {a: 1, b: 2}
keys = ""
for key in obj {
    keys = keys + key + " "
}
print("  for key in {a:1, b:2}:", keys)
print("  [OK] For-in (object) works")

// Test 9: For-in loop (string)
print("\nTest 9: For-in Loop (String)")
chars = ""
for ch in "ABC" {
    chars = chars + ch + "-"
}
print("  for ch in 'ABC':", chars)
assert(chars == "A-B-C-", "for-in string failed")
print("  [OK] For-in (string) works")

// Test 10: C-style for loop
print("\nTest 10: C-style For Loop")
total = 0
for i = 0; i < 5; i++ {
    total = total + i
}
print("  for (i=0; i<5; i++) total =", total)
assert(total == 10, "c-style for failed")
print("  [OK] C-style for loop works")

// Test 11: Break
print("\nTest 11: Break Statement")
broken = 0
for i in range(10) {
    if (i == 5) {
        break
    }
    broken = i
}
print("  break at i=5, last value:", broken)
assert(broken == 4, "break failed")
print("  [OK] Break works")

// Test 12: Continue
print("\nTest 12: Continue Statement")
sum = 0
for i in range(10) {
    if (i % 2 == 0) {
        continue
    }
    sum = sum + i
}
print("  sum of odd numbers 0-9:", sum)
assert(sum == 25, "continue failed")
print("  [OK] Continue works")

// Test 13: Function definition and call
print("\nTest 13: Functions")
func add(a, b) {
    return a + b
}
result = add(3, 4)
print("  add(3, 4) =", result)
assert(result == 7, "function failed")
print("  [OK] Functions work")

// Test 14: Function with default-like behavior
print("\nTest 14: Function Return")
func greet(name) {
    if (name == null) {
        return "Hello, Guest!"
    }
    return "Hello, " + name + "!"
}
print("  greet('World'):", greet("World"))
print("  greet(null):", greet(null))
print("  [OK] Function return works")

// Test 15: Recursive function
print("\nTest 15: Recursion")
func factorial(n) {
    if (n <= 1) {
        return 1
    }
    return n * factorial(n - 1)
}
print("  factorial(5) =", factorial(5))
assert(factorial(5) == 120, "recursion failed")
print("  [OK] Recursion works")

// Test 16: Arrow functions
print("\nTest 16: Arrow Functions")
double = x => x * 2
print("  (x => x * 2)(5) =", double(5))
assert(double(5) == 10, "arrow function failed")

add = (a, b) => a + b
print("  ((a,b) => a + b)(3, 4) =", add(3, 4))
assert(add(3, 4) == 7, "multi-param arrow failed")

greetArrow = name => {
    return "Hi, " + name + "!"
}
print("  block arrow:", greetArrow("Test"))
print("  [OK] Arrow functions work")

// Test 17: Closures
print("\nTest 17: Closures")
func makeCounter(start) {
    return () => start
}
getStart = makeCounter(100)
print("  makeCounter(100)():", getStart())
assert(getStart() == 100, "closure failed")
print("  [OK] Closures work")

// Test 18: Higher-order functions
print("\nTest 18: Higher-order Functions")
func applyTwice(callback, value) {
    return callback(callback(value))
}
result = applyTwice(x => x * 2, 3)
print("  applyTwice(x => x*2, 3) =", result)
assert(result == 12, "higher-order failed")
print("  [OK] Higher-order functions work")

// Test 19: Compound assignment
print("\nTest 19: Compound Assignment")
n = 10
n += 5
print("  n = 10; n += 5 =", n)
assert(n == 15, "+= failed")
n -= 3
print("  n -= 3 =", n)
assert(n == 12, "-= failed")
n *= 2
print("  n *= 2 =", n)
assert(n == 24, "*= failed")
n /= 4
print("  n /= 4 =", n)
assert(n == 6, "/= failed")
print("  [OK] Compound assignment works")

// Test 20: Increment/Decrement
print("\nTest 20: Increment/Decrement")
i = 5
j = i++
print("  i=5; j=i++ => i:", i, "j:", j)
k = ++i
print("  k=++i => i:", i, "k:", k)
print("  [OK] Increment/Decrement work")

// Test 21: Logical operators
print("\nTest 21: Logical Operators")
print("  true && true =", true && true)
print("  true && false =", true && false)
print("  false || true =", false || true)
print("  !true =", !true)
print("  [OK] Logical operators work")

// Test 22: Comparison operators
print("\nTest 22: Comparison Operators")
print("  5 == 5:", 5 == 5)
print("  5 != 3:", 5 != 3)
print("  5 > 3:", 5 > 3)
print("  5 >= 5:", 5 >= 5)
print("  3 < 5:", 3 < 5)
print("  5 <= 5:", 5 <= 5)
print("  [OK] Comparison operators work")

// Test 23: String concatenation
print("\nTest 23: String Concatenation")
str1 = "Hello"
str2 = " World"
combined = str1 + str2
print("  'Hello' + ' World' =", combined)
assert(combined == "Hello World", "concat failed")
print("  [OK] String concatenation works")

// Test 24: Template strings
print("\nTest 24: Template Strings")
name = "Jeem"
version = 3
msg = "Welcome to {{name}} v{{version}}!"
print("  Template:", msg)
assert(msg == "Welcome to Jeem v3!", "template failed")

// Test expression in template
calc = "Result: {{5 + 3}}"
print("  {{5+3}}:", calc)
print("  [OK] Template strings work")

// Test 25: Null handling
print("\nTest 25: Null Handling")
nothing = null
print("  null:", nothing)
print("  null == null:", null == null)
print("  null == false:", null == false)
print("  [OK] Null handling works")

print("\n\n=== All Statement Tests Complete ===")
